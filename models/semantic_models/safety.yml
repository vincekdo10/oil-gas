semantic_models:
  - name: safety
    description: "Safety metrics semantic model for incident tracking"
    model: ref('int_safety_metrics_monthly')
    defaults:
      agg_time_dimension: incident_month
    
    entities:
      - name: incident_month_rig
        type: primary
        expr: concat(incident_month, '-', rig_id)
      - name: rig_id
        type: foreign
    
    dimensions:
      - name: incident_month
        type: time
        type_params:
          time_granularity: month
      
      - name: rig_name
        type: categorical
      
      - name: basin
        type: categorical
      
      - name: rig_type
        type: categorical
    
    measures:
      - name: total_incidents
        description: "Total safety incidents"
        agg: sum
      
      - name: critical_incidents
        description: "Critical safety incidents"
        agg: sum
        expr: critical_severity_count
      
      - name: total_days_away_from_work
        description: "Total days away from work due to incidents"
        agg: sum
      
      - name: avg_resolution_days
        description: "Average days to resolve incidents"
        agg: average
        expr: avg_resolution_days
      
      - name: incident_count
        description: "Count of incident records"
        agg: count
        expr: 1

semantic_models:
  - name: safety
    description: "Safety metrics semantic model for incident tracking"
    model: ref('safety_dashboard')
    
    entities:
      - name: rig_id
        type: primary
        expr: rig_id
    
    dimensions:
      - name: rig_name
        type: categorical
        expr: rig_name
      
      - name: basin
        type: categorical
        expr: basin
      
      - name: rig_type
        type: categorical
        expr: rig_type
      
      - name: safety_rating_ltm
        type: categorical
        expr: safety_rating_ltm
    
    measures:
      - name: total_incidents_ytd
        description: "Total safety incidents year-to-date"
        agg: sum
        expr: incidents_ytd
      
      - name: total_incidents_ltm
        description: "Total safety incidents (last 12 months)"
        agg: sum
        expr: incidents_ltm
      
      - name: critical_incidents_ltm
        description: "Critical safety incidents (last 12 months)"
        agg: sum
        expr: critical_incidents_ltm
      
      - name: avg_resolution_days_ltm
        description: "Average days to resolve incidents (last 12 months)"
        agg: average
        expr: avg_resolution_days_ltm
      
      - name: avg_incident_rate_ltm
        description: "Average incident rate per 200k hours (last 12 months)"
        agg: average
        expr: incident_rate_ltm
      
      - name: rigs_with_incidents
        description: "Number of rigs with incidents"
        agg: count
        expr: rig_id


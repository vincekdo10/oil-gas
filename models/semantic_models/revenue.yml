semantic_models:
  - name: revenue
    description: "Service revenue semantic model for AI chatbot queries"
    model: ref('fact_service_operations')
    defaults:
      agg_time_dimension: service_date
    
    entities:
      - name: order_id
        type: primary
      - name: customer_id
        type: foreign
      - name: rig_id
        type: foreign
      - name: well_id
        type: foreign
    
    dimensions:
      - name: service_date
        type: time
        type_params:
          time_granularity: day
      
      - name: service_type
        type: categorical
      
      - name: customer_name
        type: categorical
      
      - name: contract_tier
        type: categorical
      
      - name: basin
        type: categorical
        expr: coalesce(well_basin, rig_basin)
      
      - name: rig_type
        type: categorical
      
      - name: status
        type: categorical
    
    measures:
      - name: total_revenue
        description: "Total service revenue"
        agg: sum
        expr: revenue_usd
      
      - name: avg_revenue_per_order
        description: "Average revenue per order"
        agg: average
        expr: revenue_usd
      
      - name: order_count
        description: "Number of service orders"
        agg: count_distinct
        expr: order_id
      
      - name: total_service_days
        description: "Total service days"
        agg: sum
        expr: duration_days
      
      - name: avg_crew_size
        description: "Average crew size"
        agg: average
        expr: crew_size
